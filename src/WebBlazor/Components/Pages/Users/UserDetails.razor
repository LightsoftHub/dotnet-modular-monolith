@page "/user/{id}"
@using Light.Identity
@using ModularMonolith.WebBlazor.Infrastructure.HttpServices.Identity

<PageHeader Title="User Details" />

@if (user is not null)
{
    <div class="row">
        <div class="col-lg-4 col-xxl-3">
            <Card>
                <div class="text-center">
                    <FluentPersona Name="@($"{user.FirstName} {user.LastName}")"
                                   Status="PresenceStatus.Available"
                                   StatusSize="PresenceBadgeSize.Small"
                                   StatusTitle="He is available"
                                   Image="/images/no-image.png"
                                   ImageSize="50px">
                    </FluentPersona>
                </div>

                <div class="mt-3">
                    <FluentIcon Value="@(new Icons.Regular.Size20.Phone())" /> @user.PhoneNumber
                    <br />
                    <FluentIcon Value="@(new Icons.Regular.Size20.Mail())" /> @user.Email
                </div>
                
            </Card>
        </div>
    </div>
}

@code {
    [Parameter]
    public string Id { get; set; } = null!;

    [Inject]
    private UserHttpService userHttpService { get; set; } = default!;

    private UserDto? user { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var getUserDetails = await userHttpService.GetByIdAsync(Id);
        if (getUserDetails.Succeeded)
        {
            user = getUserDetails.Data;
        }
        else
        {
            NavigationManager.NavigateTo("/");
        }
    }
}
